<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta content="CHAPTER 2. 동작 파라미터화 코드 전달하기" name="description"> <meta name="keywords" content="Java,Java8"> <meta name="author" content="Lee Suyoun"> <meta name="baseurl" content=""> <title> Youn's|Java8 in Action : CHAPTER_02 </title> <!-- favicon --> <link rel="shortcut icon" href="/static/assets/img/favicon.ico"> <!-- Main CSS --> <link href="/static/assets/app-20171204.min.css" rel="stylesheet"> <link href="/static/css/custom.css" rel="stylesheet"> <!-- Main Scripts --> <script src="/static/assets/app-20171204.min.js"></script> <script src="/static/assets/blog-20171204.min.js"></script> </head> <body id="page-top" class="landing-page"> <div class="search-tool" style="position: fixed; top: 0px ; bottom: 0px; left: 0px; right: 0px; opacity: 0.95; background-color: #111111; z-index: 9999; display: none;"> <input type="text" class="form-control search-content" id="search-content" style="position: fixed; top: 60px" placeholder="Search Blog"> <div style="position: fixed; top: 16px; right: 16px; z-index: 9999;"> <img src="/static/assets/img/search/cb-close.png" id="close-btn"/> </div> </div> <div style="position: fixed; right: 16px; bottom: 20px; z-index: 9999;"> <img src="/static/assets/img/search/cb-search.png" id="search-btn" title="Double click Ctrl"/> </div> <div class="navbar-wrapper"> <nav class="navbar navbar-default navbar-fixed-top" role="navigation"> <div class="container"> <div class="navbar-header page-scroll"> <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href="/">Youn's</a> </div> <div id="navbar" class="navbar-collapse collapse"> <ul class="nav navbar-nav navbar-right"> <li><a class="page-scroll" href="blog/"></a></li> <li> <a class="page-scroll" href="/blog/">Blog</a></li> <li> <a class="page-scroll" href="/java/">Java</a></li> <li> <a class="page-scroll" href="/web/">Web</a></li> <li> <a class="page-scroll" href="/database/">Database</a></li> <li> <a class="page-scroll" href="/book/">Book</a></li> <li> <a class="page-scroll" href="/etc/">Etc</a></li> </ul> </div> </div> </nav> </div> <div class="wrapper wrapper-content animated fadeInRight article"> <div class="row"> <div class="col-lg-10 col-lg-offset-1"> <div class="ibox"> <div class="ibox-content"> <div class="pull-right"> <a class="btn btn-white btn-xs" href="/book">Book</a> </div> <div class="text-center article-title"> <span class="text-muted"><i class="fa fa-clock-o"></i> 6 Dec 2017</span> <h1> Java8 in Action : CHAPTER_02 </h1> </div> <h2 id="chapter-2-동작-파라미터화-코드-전달하기">CHAPTER 2. 동작 파라미터화 코드 전달하기</h2> <ul> <li>동작 파라미터화<sup>behavior parameterization</sup>를 이용하면 자주 바뀌는 요구사항에 효과적으로 대응</li> <li>동작 파라미터화란 아직은 어떻게 실행할 것인지 결정하지 않은 코드 블록을 의미</li> </ul> <h3 id="21-변화하는-요구사항에-대응하기">2.1 변화하는 요구사항에 대응하기</h3> <ul> <li>예제 코드를 점점 개선하면서 유연한 코드를 만드는 모범사례.</li> </ul> <blockquote> <p>첫 번째 시도 : 녹색 사과 필터링</p> </blockquote> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="nf">filterGreenApples</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="n">inventory</span><span class="o">){</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>     <span class="o">&lt;--</span> <span class="err">사과</span> <span class="err">누적</span> <span class="err">리스트</span>
    <span class="k">for</span><span class="o">(</span><span class="n">Apple</span> <span class="nl">apple:</span> <span class="n">inventory</span><span class="o">){</span>
        <span class="k">if</span><span class="o">(</span><span class="s">"green"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">apple</span><span class="o">.</span><span class="na">getColor</span><span class="o">())){</span>   <span class="o">&lt;--</span> <span class="err">녹색</span> <span class="err">사과만</span> <span class="err">선택</span>
            <span class="n">result</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">apple</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div> <blockquote> <p>두 번째 시도 : 색을 파라미터화</p> </blockquote> <ul> <li>색을 파라미터화 할수 있도록 메서드에 파라미터</li> </ul> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="nf">filterApplesByColor</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="n">inventory</span><span class="o">,</span> <span class="n">String</span> <span class="n">color</span><span class="o">){</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
    <span class="k">for</span><span class="o">(</span><span class="n">Apple</span> <span class="nl">apple:</span> <span class="n">inventory</span><span class="o">){</span>
        <span class="k">if</span><span class="o">(</span><span class="n">apple</span><span class="o">.</span><span class="na">getColor</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">color</span><span class="o">)){</span>
            <span class="n">result</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">apple</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div> <ul> <li>메서드 호출</li> </ul> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">List</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="n">greenApples</span> <span class="o">=</span> <span class="n">filterApplesByColor</span><span class="o">(</span><span class="n">inventory</span><span class="o">,</span> <span class="s">"green"</span><span class="o">);</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="n">redApples</span>  <span class="o">=</span> <span class="n">filterApplesByColor</span><span class="o">(</span><span class="n">inventory</span><span class="o">,</span> <span class="s">"red"</span><span class="o">);</span>
</code></pre></div></div> <ul> <li>다양한 무게에 대응 할수 있도록 무게 정보 파라미터 추가</li> </ul> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="nf">filterApplesByWeight</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="n">inventory</span><span class="o">,</span> <span class="kt">int</span> <span class="n">weight</span><span class="o">){</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
    <span class="k">for</span><span class="o">(</span><span class="n">Apple</span> <span class="nl">apple:</span> <span class="n">inventory</span><span class="o">){</span>
        <span class="k">if</span><span class="o">(</span><span class="n">apple</span><span class="o">.</span><span class="na">getWeight</span><span class="o">()</span> <span class="o">&gt;</span> <span class="n">weight</span><span class="o">){</span>
            <span class="n">result</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">apple</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div> <ul> <li>위의 코드도 좋은 해결책이라고 할수 있지만 소프트웨어 공학의 <strong>DRY(don’t repeat yourself)</strong> 원칙을 어기는 것.</li> <li>성능을 개선하려 한다면, 한줄이 아니라 메서드 <strong>전체</strong> 구현을 고쳐야 함.</li> </ul> <blockquote> <p>세 번째 시도 : 가능한 모든 속성으로 필터링</p> </blockquote> <ul> <li>모든 속성을 메서드 인수로 추가한 모슴</li> </ul> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="nf">filterApples</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="n">inventory</span><span class="o">,</span> <span class="n">String</span> <span class="n">color</span><span class="o">,</span> <span class="kt">int</span> <span class="n">weight</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">flag</span><span class="o">){</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
    <span class="k">for</span><span class="o">(</span><span class="n">Apple</span> <span class="nl">apple:</span> <span class="n">inventory</span><span class="o">){</span>
        <span class="k">if</span><span class="o">((</span><span class="n">flag</span> <span class="o">&amp;&amp;</span> <span class="n">apple</span><span class="o">.</span><span class="na">getColor</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">color</span><span class="o">))</span> <span class="o">||</span>
            <span class="o">(!</span><span class="n">flag</span> <span class="o">&amp;&amp;</span> <span class="n">apple</span><span class="o">.</span><span class="na">getWeight</span><span class="o">()</span> <span class="o">&gt;</span> <span class="n">weight</span><span class="o">)){</span>     <span class="o">&lt;--</span> <span class="err">색이나</span> <span class="err">무게를</span> <span class="err">선택하는</span> <span class="err">방법이</span> <span class="err">맘에</span> <span class="err">들지</span> <span class="err">않음</span><span class="o">.</span>
            <span class="n">result</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">apple</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div> <ul> <li>다음처럼 위 메서드를 활용</li> </ul> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">List</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="n">greenApples</span> <span class="o">=</span> <span class="n">filterApples</span><span class="o">(</span><span class="n">inventory</span><span class="o">,</span> <span class="s">"green"</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="n">heavyApples</span> <span class="o">=</span> <span class="n">filterApples</span><span class="o">(</span><span class="n">inventory</span><span class="o">,</span> <span class="s">""</span><span class="o">,</span> <span class="mi">150</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
</code></pre></div></div> <ul> <li>여러 중복된 필터 메서드를 만들거나 아니면 모든 것을 처리하는 거대한 하나의 필터 메서드를 구현, 지금까지 문자열, 정수 불린 등의 값으로 filterApples 메서드를 파라미터화 함.</li> <li>어떤기준으로 사과를 필터링할 것인지 효과적으로 전달 할수 있다면 더 좋은 방법.</li> </ul> <hr /> <h3 id="22-동작-파라미터화">2.2 동작 파라미터화</h3> <ul> <li>어떤 속성에 기초해서 불린값을 반환, 이와 같은 동작은 <strong>프레디케이트<sup>Predicate</sup></strong> 라고 함. <ul> <li>프레디케이트<sup>Predicate</sup> : 함수형 인터페이스, 조건식을 표현하는데 사용되는 인터페이스 이며, 매개변수는 1개을 받고 반환 타입음 boolean을 리턴.</li> </ul> </li> </ul> <p><code class="highlighter-rouge">그림 2-1 사과를 선택하는 다양한 전략</code></p> <p><img src="https://i.imgur.com/Moe1QwQ.png" alt="스크린샷 2017-12-05 오후 6.02.34" /></p> <ul> <li>위를 전략 디자인 패턴<sup>strategy design pattern</sup> <ul> <li>전략 디자인 패턴은 각 알고리즘(전략이라 불리는)을 캡슐화 하는 알고리즘 패밀리를 정의해둔 다음에 런타임에 알고리즘을 선택하는 기법.</li> </ul> </li> <li><strong>동작 파라미터화</strong>, 즉 메서드가 다양한 동작(또는 전략)을 <strong>받아서</strong> 내부적으로 다양한 동작을 <strong>수행</strong> 할 수 있음.</li> </ul> <blockquote> <p>네 번째 시도 : 추상적 조건으로 필터링</p> </blockquote> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="nf">filterApples</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="n">inventory</span><span class="o">,</span> <span class="n">ApplePredicate</span> <span class="n">p</span><span class="o">){</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
    <span class="k">for</span><span class="o">(</span><span class="n">Apple</span> <span class="n">apple</span> <span class="o">:</span> <span class="n">inventory</span><span class="o">){</span>
        <span class="k">if</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">test</span><span class="o">(</span><span class="n">apple</span><span class="o">)){</span>          <span class="o">&lt;--</span> <span class="err">프레디케이트</span> <span class="err">객체로</span> <span class="err">사과</span> <span class="err">검사</span> <span class="err">조건을</span> <span class="err">캡슐화</span>
            <span class="n">result</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">apple</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div> <blockquote> <p>코드/동작 전달하기</p> </blockquote> <ul> <li>위의 코드를 통해 ApplePredicate를 적절하게 구현하는 클래스를 만들면 된다. 속성과 관련한 모든 변화에 대응할 수 있는 유연한 코드를 준비 한것.</li> <li>이용자가 원하는 조건을 Predicate로 구현하여 언제든 요구사항을 반영.</li> </ul> <p><code class="highlighter-rouge">filterApples 메서드의 동장을 파라미터화</code></p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AppleRedAndHeavyPredicate</span> <span class="kd">implements</span> <span class="n">ApplePredicate</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">test</span><span class="o">(</span><span class="n">Apple</span> <span class="n">apple</span><span class="o">){</span>
        <span class="k">return</span> <span class="s">"red"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">apple</span><span class="o">.</span><span class="na">getColor</span><span class="o">())</span>
                <span class="o">&amp;&amp;</span> <span class="n">apple</span><span class="o">.</span><span class="na">getWeight</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">150</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="n">redAndHeavyApples</span> <span class="o">=</span>
    <span class="n">filter</span><span class="o">(</span><span class="n">inventory</span><span class="o">,</span> <span class="k">new</span> <span class="n">AppleRedAndHeavyPredicate</span><span class="o">());</span>
</code></pre></div></div> <h5 id="한-개의-파라미터-다양한-동작">한 개의 파라미터, 다양한 동작</h5> <ul> <li>컬렉션 탐색 로직과 각 항목에 적용할 동작을 분리 할 수 있다는 것이 동작 파라미터화의 강점.</li> <li>유연한 API를 만들려면 동작 파라미터화라는 도구가 반드시 필요.</li> </ul> <hr /> <h3 id="23-복잡한-과정-간소화">2.3 복잡한 과정 간소화</h3> <p><code class="highlighter-rouge">동작 파라미터화 : 프레디케이트로 사과 필터링</code></p> <hr> <div class="row"> <div class="col-md-6"> <h5 style="display: inline;">Tags:</h5> <button class="btn btn-white btn-xs" type="button">Java</button> <button class="btn btn-white btn-xs" type="button">Java8</button> </div> <div class="col-md-6"> <div class="small text-right"> <div> <i class="fa fa-comments-o"> </i> <span class="disqus-comment-count" data-disqus-url="http://localhost:4000/book/2017/12/06/Java8-in-Action-cp2.html">0</span> comments </div> </div> </div> </div> <br> <div class="row"> <div class="col-lg-12"> <!-- donate --> <br> <!-- share --> <div class="a2a_kit a2a_kit_size_32 a2a_default_style"> <a class="a2a_dd" href="https://www.addtoany.com/share"></a> <a class="a2a_button_facebook"></a> <a class="a2a_button_twitter"></a> <a class="a2a_button_google_plus"></a> <a class="a2a_button_linkedin"></a> <a class="a2a_button_email"></a> <!--<a class="a2a_button_wechat"></a>--> <!--<a class="a2a_button_sina_weibo"></a>--> <!--<a class="a2a_button_pocket"></a>--> </div> <script> var a2a_config = a2a_config || {}; a2a_config.color_main = "D7E5ED"; a2a_config.color_border = "AECADB"; a2a_config.color_link_text = "333333"; a2a_config.color_link_text_hover = "333333"; </script> <script async src="https://static.addtoany.com/menu/page.js"></script> <br> <!-- comment --> <div id="disqus_thread"></div> <script> /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { var d = document, s = d.createElement('script'); s.src = '//Yons's.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript> </div> </div> </div> </div> </div> </div> </div> <!-- Google analytics --> <!-- GrowingIO --> <script id="dsq-count-scr" src="https://Yons's.disqus.com/count.js" async></script> </body> </html>
